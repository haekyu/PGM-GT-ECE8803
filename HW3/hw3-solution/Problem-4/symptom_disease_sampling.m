load SymptomDisease.matimport brml.*[S,D]=size(W);% use gibbs sampling to estimate p(s|d) % Gibbâ€™s sampling: Nsamps=10000; d=rand(D,1)<p; samps=zeros(D,Nsamps);for samp=1:Nsampsr=randperm(D); % random ordering for the Gibbs sweep through the variables	for i=r         d(i)=0;         tmp=sigmoid(W*d+b,1);         E0 = sum(d.*log(p)+(1-d).*log(1-p)) + sum(s.*log(tmp))+sum((1-s).*log(1-tmp));         d(i)=1;         tmp=sigmoid(W*d+b,1);         E1 = sum(d.*log(p)+(1-d).*log(1-p)) + sum(s.*log(tmp))+sum((1-s).*log(1-tmp));         			if rand<sigmoid(E1-E0,1) % sample from the conditional p(d_i=1|,d_\i,s)             d(i)=1;			else d(i)=0;			end 			end    samps(:,samp)=d;end	burnin=1000; %imagesc(samps) mean(samps(:,burnin:end),2)% sample everage